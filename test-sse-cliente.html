<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Test SSE Cliente</title>
</head>
<body>
    <h1>Test SSE Cliente</h1>
    <div id="log"></div>

    <script>
        const log = document.getElementById('log');

        function addLog(msg) {
            const time = new Date().toLocaleTimeString();
            log.innerHTML += `<div>${time}: ${msg}</div>`;
            console.log(msg);
        }

        addLog('Iniciando test...');

        const eventSource = new EventSource('test-sse-simple.php');

        eventSource.onopen = () => {
            addLog('âœ… ConexiÃ³n establecida');
        };

        eventSource.addEventListener('test', (e) => {
            addLog('ðŸ“¥ Evento TEST: ' + e.data);
        });

        eventSource.addEventListener('ping', (e) => {
            addLog('ðŸ“¥ Evento PING: ' + e.data);
        });

        eventSource.onerror = (error) => {
            addLog('âŒ Error: ' + JSON.stringify(error));
            addLog('ReadyState: ' + eventSource.readyState);
        };

        setTimeout(() => {
            addLog('Cerrando conexiÃ³n...');
            eventSource.close();
            addLog('âœ… Test completado');
        }, 10000);
    </script>
</body>
</html>